<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8" />
      <script src="../script.js"></script>
      <link rel="stylesheet" href="../css/styles.css">
      <link rel="icon" href="../images/logo-light.svg" media="(prefers-color-scheme: light)">
      <link rel="icon" href="../images/logo-dark.svg" media="(prefers-color-scheme: dark)">

      <title>Descarcasses Assurances</title>
   </head>
   <body>
   <header>
      <h1>title</h1>
      <h2>slogan</h2>
   </header>
      <h3>
         Obtenez une soumission personnalisée en quelques clics&nbsp!
      </h3>
      <p>
         Remplissez le formulaire ci-dessous pour que nous puissions vous offrir une couverture sur mesure, au meilleur tarif,
         selon votre véhicule, votre profil et vos habitudes de conduites
      </p>
      <p>
         N’attendez pas le dernier moment pour vous assurer. Profitez dès maintenant de nos offres avantageuses et partez l’esprit tranquille&nbsp!
      </p>
      <form>
         <!--question 1-->
         <div class="row">  
            <label for="gender" class="quest">
               Quel est votre genre&nbsp?
            </label>
            <select type="text" id="gender" name="userGender" required>
               <option disabled selected value> -- Choisissez une option -- </option>
               <option value="1">Homme</option>
               <option value="2">Femme</option>
               <option value="3">Non-binaire</option>
            </select>
         </div>

         <!--question 2-->
         <div class="row">
            <label for="userBirthDate" class="quest">
               Quel est votre date de naissance&nbsp?
            </label>
            <input type="date" id="birth" name="userBirthDate" required>
            <div class="err" id="err_age"></div>
         </div>

         <!--question 3-->
         <div class="row">
            <label for="carCost" class="quest">
               Quelle est la valeur d'achat de votre véhicule&nbsp?
            </label>
            <input type="number" id="carCost" name="carCost">
            <div class="err" id="err_carPrice"></div>
         </div>

         <!--question 4-->
         <div class="row">
            <label for="yearFabric" class="quest">
               Quelle est l'année de fabrication de votre véhicule&nbsp?
            </label>
            <select id="numClaim" name="Claim1" required>
                  <option disabled selected value> -- Choisissez une option -- </option>
                  <option value="2025">2025</option>
                  <option value="2024">2024</option>
                  <option value="2023">2023</option>
                  <option value="2022">2022</option>
                  <option value="2021">2021</option>
                  <option value="2020">2020</option>
                  <option value="2019">2019</option>
                  <option value="2018">2018</option>
                  <option value="2017">2017</option>
                  <option value="2016">2016</option>
                  <option value="2015">2015</option>
                  <option value="2014">2014</option>
                  <option value="2013">2013</option>
                  <option value="2012">2012</option>
                  <option value="2011">2011</option>
                  <option value="2010">2010</option>
                  <option value="2009">2009</option>
                  <option value="2008">2008</option>
                  <option value="2007">2007</option>
                  <option value="2006">2006</option>
                  <option value="2005">2005</option>
                  <option value="2004">2004</option>
                  <option value="2003">2003</option>
                  <option value="2002">2002</option>
                  <option value="2001">2001</option>
                  <option value="carTooOld">2000 et avant</option>
               </select>
         </div>

         <!--question 5-->
         <div class="row">
            <label for="mileage" class="quest">
               Combien de kilomètres parcourez-vous par année&nbsp?
            </label>
            <input type="number" id="mileage" name="mileage">
            <div class="err" id="err_mileage"></div>
         </div>

         <!--question 6-->
         <div class="row">
            <label for="haveBackupCam" class="quest">
               Est-ce que votre véhicule possède une caméra de recul&nbsp?
            </label>
            <select id="cam" name="haveBackupCam">
                  <option value="true">Oui</option>
                  <option value="false">Non</option>A une reclamation d'assurance
            </select>
         </div>
         
         <!--question 7-->
         <div class="row">
            <label for="hasClaim" class="quest">
               Avez-vous fait des réclamations d'assurance auto dans les 6 dernières années&nbsp?
            </label>
            <select type="text" id="hasClaim" name="hasClaim" required>
                  <option value="true">Oui</option>
                  <option value="false">Non</option>
            </select>
         </div>
         
         <div class="haveClaim">
            <!--question 7.1-->
            <div class="row">
               <label for="numClaim" class="quest">
                  Combien de réclamations avez-vous faites&nbsp?
               </label>
               <select type="text" id="numClaim" name="Claim1" required>
                  <option disabled selected value> -- choisissez une option -- </option>
                  <option value="1">1 réclamation</option>
                  <option value="2">2 réclamations</option>
                  <option value="3">3 réclamations</option>
                  <option value="4">4 réclamations</option>
                  <option value="tooMuchClaim">5 réclamations ou plus</option>
               </select>
            </div>
            <div class="claims">
               <!--question 7.1.1-->
               <div class="row">
                  <label for="Claim1" class="quest">
                     Pour la réclamation 1, quel montant avez-vous réclamé&nbsp?
                  </label>
                  <input type="number" id="amount" name="Claim1">
                  <div class="err" id="err_Claim1"></div>
               </div>

               <!--question 7.1.2-->
               <div class="row">
                  <label for="Claim2" class="quest">
                     Pour la réclamation 2, quel montant avez-vous réclamé&nbsp?
                  </label>
                  <input type="number" id="amount" name="Claim2">
                  <div class="err" id="err_Claim2"></div>
               </div>

               <!--question 7.1.3-->
               <div class="row">
                  <label for="Claim3" class="quest">
                     Pour la réclamation 3, quel montant avez-vous réclamé&nbsp?
                  </label>
                  <input type="number" id="amount" name="Claim3">
                  <div class="err" id="err_Claim3"></div>
               </div>

               <!--question 7.1.4-->
               <div class="row">
                  <label for="Claim4" class="quest">
                     Pour la réclamation 4, quel montant avez-vous réclamé&nbsp?
                  </label>
                  <input type="number" id="amount" name="Claim4">
                  <div class="err" id="err_Claim4"></div>
               </div>
            </div>
         </div>
         <div class="row">
            <button type="submit" value="Submit">Soumission</button>
         </div>
         
      </form>
      <script>
            var birth = document.getElementById("birth");
            birth.addEventListener("blur", function() {
               var birthDate = new Date(birthInput.value);
               var today = new Date();
               var future = false;
               if(today.getFullYear() < birthDate.getFullYear()){
                  future = true;
               } else if (today.getFullYear() == birthDate.getFullYear()){
                  if(today.getMonth() < birthDate.getMonth()){
                     future = true;
                  }else if(today.getMonth() == birthDate.getMonth()){
                     if(today.getDate() <= birthDate.getDate()){
                        future = true;
                     }
                  }
               }

               if(future == true) {
                  document.getElementById("err_age").textContent = "La date de naissance ne peut pas être dans le futur";
               } else {
                  document.getElementById("err_age").textContent = "";
               }
            });

            costInput = document.getElementById("carCost");
            costInput.addEventListener("blur", function () {
               if (costInput.value == "" || costInput.value < 0 || isNaN(costInput.value)) {
                  document.getElementById("err_carPrice").textContent = "Le prix doit être un nombre positif.";
               } else {
                  document.getElementById("err_carPrice").textContent = "";
               }
            });

            mileageInput = document.getElementById("mileage");
            mileageInput.addEventListener("blur", function () {
               if (mileageInput.value == "" || mileageInput.value < 0 || isNaN(mileageInput.value)) {
                  document.getElementById("err_mileage").textContent = "Le kilométrage doit être un nombre positif.";
               } else {
                  document.getElementById("err_mileage").textContent = "";
               }
            });

            firstClaimInput = document.getElementById("Claim1");
            firstClaimInput.addEventListener("blur", function () {
               if (firstClaimInput.value == "" || firstClaimInput.value < 0 || isNaN(firstClaimInput.value)) {
                  document.getElementById("err_Claim1").textContent = "Le montant doit être un nombre positif.";
               } else {
                  document.getElementById("err_Claim1").textContent = "";
               }
            });

            secondClaimInput = document.getElementById("Claim2");
            secondClaimInput.addEventListener("blur", function () {
               if (secondClaimInput.value == "" || secondClaimInput.value < 0 || isNaN(secondClaimInput.value)) {
                  document.getElementById("err_Claim2").textContent = "Le montant doit être un nombre positif.";
               } else {
                  document.getElementById("err_Claim2").textContent = "";
               }
            });

            thirdClaimInput = document.getElementById("Claim3");
            thirdClaimInput.addEventListener("blur", function () {
               if (thirdClaimInput.value == "" || thirdClaimInput.value < 0 || isNaN(thirdClaimInput.value)) {
                  document.getElementById("err_Claim3").textContent = "Le montant doit être un nombre positif.";
               } else {
                  document.getElementById("err_Claim3").textContent = "";
               }
            });

            fourthClaimInput = document.getElementById("Claim4");
            fourthClaimInput.addEventListener("blur", function () {
               if (fourthClaimInput.value == "" || fourthClaimInput.value < 0 || isNaN(fourthClaimInput.value)) {
                  document.getElementById("err_Claim4").textContent = "Le montant doit être un nombre positif.";
               } else {
                  document.getElementById("err_Claim4").textContent = "";
               }
            });

            document.getElementById("Form").addEventListener("submit", function(event) {

               event.preventDefault();
               genderSelect = document.getElementById("gender").value;
               birthInput = document.getElementById("birth").value;
               costInput = document.getElementById("carCost").value;
               yearSelect = document.getElementById("yearFabric").value;
               mileageInput = document.getElementById("mileage").value;
               backupCamSelect = document.getElementById("cam").value;
               claimSelect = document.getElementById("hasClaim").value;
               numClaimSelect = document.getElementById("numClaim").value;

               
               firstClaimInput = document.getElementById("Claim1").value;
               secondClaimInput = document.getElementById("Claim2").value;
               thirdClaimInput = document.getElementById("Claim3").value;
               fourthClaimInput = document.getElementById("Claim4").value;
               totalReclam = firstClaimInput + secondClaimInput + thirdClaimInput + fourthClaimInput;


               
               if(genderSelect == "femme" || age < 16) {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(genderSelect == "homme" || age < 18) {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(genderSelect == "non-binaire" || age < 18) {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(age >= 100) {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(yearSelect == "carTooOld") {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(costInput > 100000 &&  mileageInput > 50000) {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else if(numClaimSelect == "tooMuchClaim" && backupCamSelect == "false") {
                  message = `vous n'êtes pas éligible à notre assurance`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               } 
               else {
                  if(genderSelect == "homme" || age < 25) {
                     assuranceAnnuelle = 0.05*costInput + 350*numClaimSelect + 0.02*mileageInput;
                  } else if(genderSelect == "non-binaire" || age < 25) {
                     assuranceAnnuelle = 0.05*costInput + 350*numClaimSelect + 0.02*mileageInput;
                  } else if(age>75) {
                     assuranceAnnuelle = 0.04*costInput + 350*numClaimSelect + 0.02*mileageInput;
                  } else {
                     assuranceAnnuelle = 0.015*costInput + 350*numClaimSelect + 0.02*mileageInput;
                  }

                  if(totalReclam > 25000) {
                     assuranceAnnuelle = assuranceAnnuelle + 700;
                  }

                  message = `Le montant de votre assurance s'élève à ${assuranceAnnuelle}$.`;
                  document.getElementById("err_value_nom_de_la_var").textContent = message;
               }
            });
      </script>
   </body>
</html>
